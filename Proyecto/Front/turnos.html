<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Solicitar Turno - SALUD TOTAL</title>
  <link rel="stylesheet" href="/Proyecto/Front/Home_Login.html">
  <link rel="stylesheet" href="estilos.css">

</head>
<body class="body-turno">
  <header class="head-turno">
    <h1>Solicitar Turno</h1>
    <a href="Home_Login.html" class="boton-secundario">Volver al Inicio</a>
  </header>

 <section id="solicitar-turno">
  <h2>Solicitar Turno</h2>

  <form class="form-turno">
    <div class="grupo-form">
      <label for="especialidad">Especialidad:</label>
      <select id="especialidad" name="especialidad">
        <option value="">Seleccione una especialidad</option>
        <option value="clinica">Clínica Médica</option>
        <option value="pediatria">Pediatría</option>
        <option value="cardiologia">Cardiología</option>
        <option value="ginecologia">Ginecología</option>
      </select>
    </div>

    <div class="grupo-form">
      <label for="profesional">Profesional:</label>
      <select id="profesional" name="profesional">
        <option value="">Seleccione un profesional</option>
        <!-- Se cargan dinámicamente en un sistema real -->
        <option value="1">Dra. María Pérez</option>
        <option value="2">Dr. Juan López</option>
      </select>
    </div>

    <div class="grupo-form">
      <label for="fecha">Fecha:</label>
      <input type="date" id="fecha" name="fecha">
    </div>

    <div class="grupo-form">
      <label for="horario">Horario:</label>
      <select id="horario" name="horario">
        <option value="">Seleccione un horario</option>
        <option>08:00</option>
        <option>09:30</option>
        <option>11:00</option>
        <option>15:30</option>
        <option>17:00</option>
      </select>
    </div>

    <button type="submit" class="boton-principal">Confirmar Turno</button>
  </form>
</section>
<script>

document.querySelector('.form-turno').addEventListener('submit', async function (e) {
  e.preventDefault();

  const especialidad = document.getElementById('especialidad').value;
  const profesional = document.getElementById('profesional').value;
  const fecha = document.getElementById('fecha').value;
  const horario = document.getElementById('horario').value;

  const pacienteId = localStorage.getItem("pacienteId"); // Debes guardar esto al hacer login

  const response = await fetch('http://localhost:3002/api/turnos', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
  },
    body: JSON.stringify({
      paciente_id: pacienteId,
      profesional_id: profesional,
      especialidad_id: especialidad,
      FechaTurno: `${fecha} ${horario}`,
      motivo: "Consulta general"
  })
});

  if (response.ok) {
    alert("✅ Turno solicitado con éxito");
  } else {
    alert("❌ Error al solicitar el turno");
  }
});
</script>
</body>
</html>
